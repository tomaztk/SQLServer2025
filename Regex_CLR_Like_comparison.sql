# Regex comparison


USE regexp
go
EXEC sp_configure 'clr enabled', 1
RECONFIGURE
go
DROP FUNCTION IF EXISTS CLR_RegExp_like
DROP ASSEMBLY IF EXISTS CLRRegExp
DECLARE @assembly varbinary(MAX) = 0x4D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C010300C21D8D680000000000000000E00022200B0130000008000000060000000000001A260000002000000040000000000010002000000002000004000000000000000400000000000000008000000002000000000000030040850000100000100000000010000010000000000000100000000000000000000000C82500004F000000004000009802000000000000000000000000000000000000006000000C00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E7465787400000020060000002000000008000000020000000000000000000000000000200000602E72737263000000980200000040000000040000000A0000000000000000000000000000400000402E72656C6F6300000C0000000060000000020000000E00000000000000000000000000004000004200000000000000000000000000000000FC250000000000004800000002000500DC200000EC0400000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000133002007400000001000011000F00280500000A2D340F01280500000A2D2B0F00FE16090000016F0600000A6F0700000A2C170F01FE16090000016F0600000A6F0700000A16FE012B01170A062C087E0800000A0B2B270F00FE16090000016F0600000A0F01FE16090000016F0600000A280900000A280A00000A0B2B00072A2202280B00000A002A00000042534A4201000100000000000C00000076342E302E33303331390000000005006C00000080010000237E0000EC010000BC01000023537472696E677300000000A80300000400000023555300AC030000100000002347554944000000BC0300003001000023426C6F620000000000000002000001471502000900000000FA013300160000010000000B0000000200000002000000020000000B000000040000000100000001000000030000000000CD0001000000000006005700300106007700300106002E001D010F005001000006009D01E2000A004200FC000A001F00FC000A00E9005F010A0095005F010600A100E2000E00B6017401000000000100000000000100010001001000930100001500010001005020000000009600A8003B000100D02000000000861817010600030000000100B00100000200F400090017010100110017010600190017010A003100170106004900D700160029009F001A005100BC001E004100DD0022005900B40026004100A4012C002900170106002000230075002E000B0044002E0013004D002E001B006C001000048000000000000000000000000000000000C7000000040000000000000000000000320016000000000004000000000000000000000032000A00000000000400000000000000000000003200E200000000000000003C4D6F64756C653E0053797374656D2E44617461006D73636F726C696200446174614163636573734B696E640044656275676761626C654174747269627574650053716C46756E6374696F6E41747472696275746500436F6D70696C6174696F6E52656C61786174696F6E734174747269627574650052756E74696D65436F6D7061746962696C6974794174747269627574650053716C537472696E6700546F537472696E670052656745785F4D617463680049734D61746368006765745F4C656E67746800736C61736B00736C61736B2E646C6C006765745F49734E756C6C0053797374656D0053716C426F6F6C65616E007061747465726E004D6963726F736F66742E53716C5365727665722E536572766572002E63746F720053797374656D2E446961676E6F73746963730053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300446562756767696E674D6F6465730053797374656D2E446174612E53716C54797065730053797374656D2E546578742E526567756C617245787072657373696F6E730046756E6374696F6E73004F626A656374006F705F496D706C6963697400696E70757400526567657800000000005208008D46B2CF47A183769493F0507400042001010803200001052001011111050702021121032000020320000E0320000803061121050002020E0E05000111210208B77A5C561934E0890800021121112511250801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F77730108010007010000000080B901000300540E044E616D650F434C525F5265674578705F6C696B655455794D6963726F736F66742E53716C5365727665722E5365727665722E446174614163636573734B696E642C2053797374656D2E446174612C2056657273696F6E3D342E302E302E302C2043756C747572653D6E65757472616C2C205075626C69634B6579546F6B656E3D623737613563353631393334653038390A446174614163636573730000000054020F497344657465726D696E697374696301F025000000000000000000000A260000002000000000000000000000000000000000000000000000FC250000000000000000000000005F436F72446C6C4D61696E006D73636F7265652E646C6C0000000000FF2500200010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001001000000018000080000000000000000000000000000001000100000030000080000000000000000000000000000001000000000048000000584000003C02000000000000000000003C0234000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000000000000000000000000000000003F000000000000000400000002000000000000000000000000000000440000000100560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000000B0049C010000010053007400720069006E006700460069006C00650049006E0066006F0000007801000001003000300030003000300034006200300000002C0002000100460069006C0065004400650073006300720069007000740069006F006E000000000020000000300008000100460069006C006500560065007200730069006F006E000000000030002E0030002E0030002E003000000034000A00010049006E007400650072006E0061006C004E0061006D006500000073006C00610073006B002E0064006C006C0000002800020001004C006500670061006C0043006F0070007900720069006700680074000000200000003C000A0001004F0072006900670069006E0061006C00460069006C0065006E0061006D006500000073006C00610073006B002E0064006C006C000000340008000100500072006F006400750063007400560065007200730069006F006E00000030002E0030002E0030002E003000000038000800010041007300730065006D0062006C0079002000560065007200730069006F006E00000030002E0030002E0030002E003000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000C0000001C3600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
DECLARE @hash binary(64) 
SELECT @hash = hash
FROM   sys.trusted_assemblies
WHERE  description = 'Regex test'
IF @hash IS NOT NULL
   EXEC sp_drop_trusted_assembly @hash

SELECT @hash = hashbytes('SHA2_512', @assembly) 
EXEC sp_add_trusted_assembly @hash, N'Regex test'
CREATE ASSEMBLY CLRRegExp FROM @assembly
go
CREATE FUNCTION CLR_RegExp_like(@str nvarchar(MAX), @pattern nvarchar(4000)) RETURNS bit
AS EXTERNAL NAME CLRRegExp.Functions.RegEx_Match
go
SELECT dbo.CLR_RegExp_like('nisse', 'm')

 


